$(document).ready(function(){$(".label").click(function(){$(this).siblings().css("opacity","1"),$(this).css("opacity","0")});var a=0,l=0,t=function(){console.log("in ping"),$.ajax({url:"/rain_barrel/stats",type:"GET",success:function(i){var s=i.current_volume,e=i.capacity_in_gallons,o=parseInt($("#barrel").css("height")),d=s/e,h=s/e*100,r=100-h,n=o*d;$("#water_level").animate({top:r+"%",height:n+"px"},2e3,function(){}),$(".circle-wl").animate({"margin-top":"-"+n+"px"},2e3,function(){}),$("#pH .data-elt .data-bit").html(i.ph),$("#TDS .data-elt .data-bit").html(i.total_dissolved_solids);var g={pH:"",TDS:""};i.ph<6?(g.pH="",g.pH="pH is too low ("+i.ph+")",a++,$("#pH .data-elt .data-bit").removeClass("green_highlight yellow_highlight"),$("#pH .data-elt .data-bit").addClass("red_highlight"),$("#pH .fix").css("display","block"),$("#pH .fix").css("background-color","yellow"),$(".logo span").css("color","red")):i.ph>8?(g.pH="",g.pH="pH is too high ("+i.ph+")",a++,$("#pH .data-elt .data-bit").removeClass("green_highlight yellow_highlight"),$("#pH .data-elt .data-bit").addClass("red_highlight"),$("#pH .fix").css("display","block"),$("#pH .fix").css("background-color","yellow"),$(".logo span").css("color","red")):i.ph>=6&&i.ph<=6.5||i.ph<=8&&i.ph>=7.5?($("#pH .data-elt .data-bit").removeClass("green_highlight red_highlight"),$("#pH .data-elt .data-bit").addClass("yellow_highlight"),$(".logo span").css("color","yellow")):i.ph>6.5&&i.ph<7.5&&($("#pH .data-elt .data-bit").removeClass("yellow_highlight red_highlight"),$("#pH .data-elt .data-bit").addClass("green_highlight"),$(".logo span").css("color","green")),i.total_dissolved_solids<=50?($("#TDS .data-elt .data-bit").removeClass("yellow_highlight red_highlight"),$("#TDS .data-elt .data-bit").addClass("green_highlight"),$(".logo span").css("color","green")):i.total_dissolved_solids>50&&i.total_dissolved_solids<=400?($("#TDS .data-elt .data-bit").removeClass("green_highlight red_highlight"),$("#TDS .data-elt .data-bit").addClass("yellow_highlight"),$(".logo span").css("color","yellow")):i.total_dissolved_solids>400&&(g.TDS="",g.TDS="TDS is too high ("+i.total_dissolved_solids+")",l++,$("#TDS .data-elt .data-bit").removeClass("green_highlight yellow_highlight"),$("#TDS .data-elt .data-bit").addClass("red_highlight"),$("#TDS .fix").css("display","block"),$("#TDS .fix").css("background-color","yellow"),$(".logo span").css("color","red"));for(marker in g)"pH"==marker&&""!==g[marker]&&($("#alert").css("display","block"),1==a?$(".warning-text").append("<p id='ph_warning'>"+g[marker]+"</p>"):$("#ph_warning").html(g[marker])),"TDS"==marker&&""!==g[marker]&&($("#alert").css("display","block"),1==l?$(".warning-text").append("<p id='tds_warning'>"+g[marker]+"</p>"):$("#tds_warning").html(g[marker]));i.ph>6&&i.ph<8&&i.total_dissolved_solids<400&&$("#alert").css("display","none"),setTimeout(function(){t()},1e3)}})};t(),$(".fix_link").click(function(){"none"==$(this).parent().parent().find(".fix").css("display")?$(this).parent().parent().find(".fix").css("display","block"):$(this).parent().parent().find(".fix").css("display","none")})});